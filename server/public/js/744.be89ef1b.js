"use strict";(self["webpackChunkedrans_client"]=self["webpackChunkedrans_client"]||[]).push([[744],{5447:(e,t,o)=>{o.d(t,{Z:()=>m});var a=o(3673);const i={class:"row justify-start back-button"},r={class:"col-auto"};function s(e,t,o,s,l,n){const c=(0,a.up)("q-btn");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",r,[(0,a.Wm)(c,{onClick:n.goBack,icon:"arrow_back",flat:"",label:"Atras",color:"primary",class:"q-pa-md"},null,8,["onClick"])])])}const l={name:"BackButton",methods:{goBack(){this.$router.go(-1)}}};var n=o(4260),c=o(8240),d=o(7518),u=o.n(d);const p=(0,n.Z)(l,[["render",s]]),m=p;u()(l,"components",{QBtn:c.Z})},7124:(e,t,o)=>{o.d(t,{Z:()=>u});var a=o(3673),i=o(2323);const r={class:"q-mb-md"},s={class:"text-h5 text-weight-light"};function l(e,t,o,l,n,c){return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",s,(0,i.zw)(o.title),1)])}const n={name:"Title",props:{title:{type:String,required:!0}}};var c=o(4260);const d=(0,c.Z)(n,[["render",l]]),u=d},3744:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Z});var a=o(3673);const i={class:"column items-center"},r={class:"base-width"},s={class:"column justify-between",style:{height:"600px"}},l={class:"col"},n={class:"col-auto"},c={class:"row justify-end q-gutter-sm"},d=(0,a.Uk)(" Cancelar "),u={class:"column justify-between",style:{height:"600px"}},p={class:"row justify-start q-gutter-md"},m={key:0,class:"col-auto"},h={class:"row justify-end"};function g(e,t,o,g,f,y){const k=(0,a.up)("back-button"),b=(0,a.up)("page-title"),v=(0,a.up)("q-input"),q=(0,a.up)("q-form"),w=(0,a.up)("q-btn"),D=(0,a.up)("q-card-section"),$=(0,a.up)("q-separator"),_=(0,a.up)("q-img"),C=(0,a.up)("q-uploader"),W=(0,a.up)("q-card");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(k),(0,a._)("div",r,[(0,a.Wm)(b,{title:"Editar Producto"}),(0,a.Wm)(W,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{horizontal:e.$q.screen.gt.md},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{clas:"col",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a._)("div",l,[(0,a.Wm)(q,{ref:"formRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{readonly:f.loading,modelValue:f.productDetails.nombre,"onUpdate:modelValue":t[0]||(t[0]=e=>f.productDetails.nombre=e),name:"nombre",ref:"nombreRef",label:"Nombre",rules:[e=>!!e||"Campo requerido"]},null,8,["readonly","modelValue","rules"]),(0,a.Wm)(v,{readonly:f.loading,class:"my-input",modelValue:f.productDetails.precio,"onUpdate:modelValue":t[1]||(t[1]=e=>f.productDetails.precio=e),prefix:"$",type:"precio",name:"precio",ref:"precioRef",label:"Precio",rules:[e=>!!e||"Campo requerido"]},null,8,["readonly","modelValue","rules"]),(0,a.Wm)(v,{readonly:f.loading,class:"my-input",modelValue:f.productDetails.stock,"onUpdate:modelValue":t[2]||(t[2]=e=>f.productDetails.stock=e),suffix:"un.",type:"stock",name:"stock",ref:"stockRef",label:"Stock",rules:[e=>!!e||"Campo requerido"]},null,8,["readonly","modelValue","rules"]),(0,a.Wm)(v,{readonly:f.loading,modelValue:f.productDetails.categoria,"onUpdate:modelValue":t[3]||(t[3]=e=>f.productDetails.categoria=e),type:"categoria",name:"categoria",ref:"categoriaRef",label:"Categoría",rules:[e=>!!e||"Campo requerido"]},null,8,["readonly","modelValue","rules"]),(0,a.Wm)(v,{readonly:f.loading,modelValue:f.productDetails.descripcion,"onUpdate:modelValue":t[4]||(t[4]=e=>f.productDetails.descripcion=e),type:"textarea",name:"descripcion",ref:"descripcionRef",label:"Descripción",rules:[e=>!!e||"Campo requerido"]},null,8,["readonly","modelValue","rules"])])),_:1},512)]),(0,a._)("div",n,[(0,a._)("div",c,[(0,a._)("div",null,[(0,a.Wm)(w,{flat:"",color:"primary",onClick:y.cancel},{default:(0,a.w5)((()=>[d])),_:1},8,["onClick"])]),(0,a._)("div",null,[(0,a.Wm)(w,{color:"primary",label:"Guardar",loading:f.loading,onClick:y.updateProduct},null,8,["loading","onClick"])])])])])])),_:1}),e.$q.screen.gt.md?((0,a.wg)(),(0,a.j4)($,{key:0,vertical:""})):(0,a.kq)("",!0),(0,a.Wm)(D,{clas:"col",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a._)("div",u,[(0,a._)("div",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.productDetails.fotos,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e,style:{width:"150px"}},[(0,a.Wm)(_,{src:"https://coderhouse-ecommerce.s3.amazonaws.com/"+e,style:{height:"140px","max-width":"150px"},fit:"contain","no-native-menu":""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"absolute all-pointer-events",style:{top:"8",right:"8"},icon:"close",color:"red",round:"",onClick:t=>y.removeImage(e)},null,8,["onClick"])])),_:2},1032,["src"])])))),128))]),f.productDetails.fotos.length<5?((0,a.wg)(),(0,a.iD)("div",m,[(0,a._)("div",h,[(0,a.Wm)(C,{label:"Agregar imagen","no-thumbnails":"",factory:y.factoryFn,onUploaded:y.getProductDetails,style:{width:"100%"},accept:".jpg, image/*","max-files":1},null,8,["factory","onUploaded"])])])):(0,a.kq)("",!0)])])),_:1})])),_:1},8,["horizontal"])])),_:1})])])}var f=o(7124),y=o(5447);const k={name:"EditProductPage",components:{PageTitle:f.Z,BackButton:y.Z},data(){return{loading:!1,qty:1,productDetails:{nombre:"",descripcion:"",categoria:"",precio:0,stock:0,fotos:[],id:""}}},created(){this.getProductDetails()},methods:{getProductDetails(){this.loading=!0,this.$axios({method:"GET",url:"/api/products/"+this.$route.params.id,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")}}).then((e=>{this.productDetails=e.data.data,this.loading=!1})).catch((e=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al obtener los datos del producto"})}))},updateProduct(){if(this.isInvalidForm())return;this.loading=!0;const e={nombre:this.productDetails.nombre,descripcion:this.productDetails.descripcion,categoria:this.productDetails.categoria,precio:this.productDetails.precio,stock:this.productDetails.stock};this.$axios({method:"PUT",url:"/api/products/"+this.$route.params.id,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")},data:e}).then((()=>{this.loading=!1,this.$router.push("/"),this.$q.notify({position:"bottom-right",color:"positive",message:"Producto actualizado"})})).catch((e=>{this.loading=!1,this.$q.notify({position:"bottom-right",color:"negative",message:"Error al actualizar el producto"})}))},removeImage(e){this.$axios({method:"PUT",url:"api/image",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")},data:{filename:e,productId:this.productDetails.id}}).then((()=>{this.getProductDetails(),this.$q.notify({position:"bottom-right",color:"positive",message:"Se eliminó la imagen"})})).catch((e=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al eliminar la imagen"})}))},cancel(){this.$router.push("/")},isInvalidForm(){return this.$refs.formRef.validate(),!!(this.$refs.nombreRef.hasError||this.$refs.precioRef.hasError||this.$refs.stockRef.hasError||this.$refs.categoriaRef.hasError||this.$refs.descripcionRef.hasError)},factoryFn(e){const t=/(?:\.([^.]+))?$/,o=t.exec(e[0].name)[1];return new Promise(((e,t)=>{this.$axios({method:"POST",url:"api/image/presignedurl",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")},data:{productId:this.productDetails.id,type:o}}).then((t=>{const o=t.data.data;e({url:o,method:"PUT",sendRaw:!0})})).catch((e=>{t(e)}))}))}}};var b=o(4260),v=o(151),q=o(5589),w=o(5269),D=o(4842),$=o(8240),_=o(5869),C=o(4027),W=o(3768),x=o(7518),P=o.n(x);const j=(0,b.Z)(k,[["render",g],["__scopeId","data-v-7d78bda0"]]),Z=j;P()(k,"components",{QCard:v.Z,QCardSection:q.Z,QForm:w.Z,QInput:D.Z,QBtn:$.Z,QSeparator:_.Z,QImg:C.Z,QUploader:W.Z})}}]);