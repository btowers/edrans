"use strict";(self["webpackChunkedrans_client"]=self["webpackChunkedrans_client"]||[]).push([[706],{1706:(t,o,e)=>{e.r(o),e.d(o,{default:()=>v});var a=e(3673),n=e(2323);const l=t=>((0,a.dD)("data-v-0bb22498"),t=t(),(0,a.Cn)(),t),i={class:"cartTable"},s=["src"],r=l((()=>(0,a._)("b",null,"Total:",-1))),d={style:{width:"100% flex justify-right"}};function c(t,o,e,l,c,u){const m=(0,a.up)("q-avatar"),g=(0,a.up)("q-td"),p=(0,a.up)("q-truncate"),b=(0,a.up)("q-btn"),h=(0,a.up)("q-tr"),w=(0,a.up)("sapn"),f=(0,a.up)("q-table"),_=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(_,{padding:"",class:"flex justify-center"},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(f,{title:"Carrito",rows:c.rows,columns:c.columns,"row-key":"name",loading:c.loading,"no-data-label":"No se encontraron productos en el carrito..."},{body:(0,a.w5)((t=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a._)("img",{src:"https://coderhouse-ecommerce.s3.amazonaws.com/"+t.row.product.fotos[0]},null,8,s)])),_:2},1024)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.row.product.nombre),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.row.product.descripcion),1)])),_:2},1024)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.row.qty),1)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)("$ "+t.row.product.precio),1)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,{onClick:o=>u.removeItem(t.row),flat:"",round:"",color:"red",icon:"delete"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),"bottom-row":(0,a.w5)((()=>[c.rows.length>0?((0,a.wg)(),(0,a.j4)(h,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{colspan:"100%"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[r,(0,a.Uk)(" $ "+(0,n.zw)(c.total),1)])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1},8,["rows","columns","loading"]),(0,a._)("div",d,[(0,a.Wm)(b,{class:"q-mt-md",onClick:u.buy,color:"primary",label:"Comprar",loading:c.btnLoading},null,8,["onClick","loading"])])])])),_:1})}const u={name:"Cart",data(){return{btnLoading:!1,loading:!1,total:0,rows:[],columns:[{name:"imagen",required:!0,label:"",align:"left",sortable:!1},{name:"nombre",required:!0,label:"Nombre",align:"left"},{name:"descripcion",label:"DescripciÃ³n",align:"left"},{name:"qty",label:"Cantidad",field:"qty",align:"left"},{name:"precio",label:"Precio",align:"left"},{name:"remove",label:""}]}},created(){this.getProducts()},methods:{async getProducts(){this.loading=!0,this.$axios.get("/api/cart").then((t=>{this.rows=t.data.data.products,this.total=t.data.data.products.reduce(((t,o)=>t+o.product.precio*o.qty),0),this.loading=!1})).catch((t=>{this.rows=[],this.loading=!1}))},async buy(){this.btnLoading=!0,await this.$axios.post("/api/cart/submit",{products:"brian"}).then((()=>{this.$q.notify({position:"bottom-right",color:"positive",message:"Cart has been submitted"}),this.btnLoading=!1,this.getProducts()})).catch((t=>{console.log(t),this.$q.notify({position:"bottom-right",color:"negative",message:"Cart has not been submitted"}),this.btnLoading=!1}))},async removeItem(t){this.btnLoading=!0;const o={product:t.product.id,qty:t.qty};await this.$axios.post("/api/cart/delete",o).then((()=>{this.$q.notify({position:"bottom-right",color:"positive",message:"Item has been removed from cart"}),this.btnLoading=!1,this.getProducts()})).catch((t=>{console.log(t),this.$q.notify({position:"bottom-right",color:"negative",message:"Item has not been removed from cart"}),this.btnLoading=!1}))}}};var m=e(4260),g=e(4379),p=e(8468),b=e(8186),h=e(3884),w=e(5096),f=e(8240),_=e(7518),y=e.n(_);const q=(0,m.Z)(u,[["render",c],["__scopeId","data-v-0bb22498"]]),v=q;y()(u,"components",{QPage:g.Z,QTable:p.Z,QTr:b.Z,QTd:h.Z,QAvatar:w.Z,QBtn:f.Z})}}]);