"use strict";(self["webpackChunkedrans_client"]=self["webpackChunkedrans_client"]||[]).push([[106],{4106:(e,a,r)=>{r.r(a),r.d(a,{default:()=>k});var o=r(3673),l=r(8880);const t={class:"column items-center"},s={class:"base-width"},i={class:"row justify-end q-py-md"},n={class:"q-mr-md"};function d(e,a,r,d,u,c){const m=(0,o.up)("back-button"),p=(0,o.up)("page-title"),h=(0,o.up)("q-input"),f=(0,o.up)("q-card-section"),y=(0,o.up)("q-separator"),g=(0,o.up)("q-icon"),b=(0,o.up)("q-form"),w=(0,o.up)("q-btn"),$=(0,o.up)("q-card");return(0,o.wg)(),(0,o.iD)("div",t,[(0,o.Wm)(m),(0,o._)("div",s,[(0,o.Wm)(p,{title:"Editar Perfil"}),(0,o.Wm)($,{class:"q-pa-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{horizontal:e.$q.screen.gt.md},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{modelValue:u.user.nombre,"onUpdate:modelValue":a[0]||(a[0]=e=>u.user.nombre=e),readonly:"",name:"nombre",label:"Nombre"},null,8,["modelValue"]),(0,o.Wm)(h,{modelValue:u.user.email,"onUpdate:modelValue":a[1]||(a[1]=e=>u.user.email=e),readonly:"",type:"email",name:"email",label:"Email"},null,8,["modelValue"]),(0,o.Wm)(h,{modelValue:u.user.identificador,"onUpdate:modelValue":a[2]||(a[2]=e=>u.user.identificador=e),readonly:"",name:"identificador",label:"DNI"},null,8,["modelValue"])])),_:1}),e.$q.screen.gt.md?((0,o.wg)(),(0,o.j4)(y,{key:0,vertical:""})):(0,o.kq)("",!0),(0,o.Wm)(f,{style:{width:"100%"}},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{ref:"formRef"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.direccion.calle,"onUpdate:modelValue":a[3]||(a[3]=e=>u.user.direccion.calle=e),name:"calle",ref:"calleRef",label:"Calle","lazy-rules":"",rules:[e=>!!e||"Campo requerido",e=>!!e.match(/^[a-zA-Z0-9\s]{3,}$/)||"La calle debe tener al menos 3 caracteres"]},null,8,["readonly","onKeyup","modelValue","rules"]),(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.direccion.altura,"onUpdate:modelValue":a[4]||(a[4]=e=>u.user.direccion.altura=e),name:"altura",ref:"alturaRef",label:"Altura","lazy-rules":"",rules:[e=>!!e||"Campo requerido",e=>!!e.match(/^[0-9]{1,4}$/)||"La altura debe tener entre 1 y 4 digitos"]},null,8,["readonly","onKeyup","modelValue","rules"]),(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.direccion.cp,"onUpdate:modelValue":a[5]||(a[5]=e=>u.user.direccion.cp=e),name:"cp",ref:"cpRef",label:"CP","lazy-rules":"",rules:[e=>!!e||"Campo requerido",e=>!!e.match(/^[0-9]{1,4}$/)||"El CP debe tener entre 1 y 4 digitos"]},null,8,["readonly","onKeyup","modelValue","rules"]),(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.direccion.piso,"onUpdate:modelValue":a[6]||(a[6]=e=>u.user.direccion.piso=e),name:"piso",ref:"pisoRef",label:"Piso","lazy-rules":"",rules:[e=>!!e.match(/^(\s*|\d+)$/)||"El piso debe tener entre 0 y 3 digitos"]},null,8,["readonly","onKeyup","modelValue","rules"]),(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.direccion.departamento,"onUpdate:modelValue":a[7]||(a[7]=e=>u.user.direccion.departamento=e),name:"departamento",ref:"departamentoRef",label:"Departamento","lazy-rules":"",rules:[e=>!!e.match(/^[a-zA-Z]{0,3}$/)||"El departamento debe tener entre 0 y 3 letras"]},null,8,["readonly","onKeyup","modelValue","rules"]),(0,o.Wm)(h,{readonly:u.loading,onKeyup:(0,l.D2)(c.updateUser,["enter"]),modelValue:u.user.password,"onUpdate:modelValue":a[9]||(a[9]=e=>u.user.password=e),type:u.isPwd?"password":"text",name:"password",ref:"passwordRef",label:"Nueva Contraseña","lazy-rules":"",rules:[e=>!!e.match(/^\s*$|(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&]{8,}/)||"La contraseña debe contener al menos 8 caracteres, 1 numero, 1 letra mayuscula y un símbolo"]},{append:(0,o.w5)((()=>[(0,o.Wm)(g,{name:u.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[8]||(a[8]=e=>u.isPwd=!u.isPwd)},null,8,["name"])])),_:1},8,["readonly","onKeyup","modelValue","type","rules"])])),_:1},512)])),_:1})])),_:1},8,["horizontal"]),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",n,[(0,o.Wm)(w,{disable:u.loading,flat:"",onClick:a[10]||(a[10]=e=>this.$router.push("/")),color:"primary",label:"Cancelar"},null,8,["disable"])]),(0,o._)("div",null,[(0,o.Wm)(w,{disable:u.loading,loading:u.loading,onClick:c.updateUser,color:"primary",label:"Actualizar"},null,8,["disable","loading","onClick"])])])])),_:1})])),_:1})])])}var u=r(7124),c=r(5447);const m={name:"RegisterPage",components:{PageTitle:u.Z,BackButton:c.Z},data(){return{loading:!1,user:{id:"",nombre:"",email:"",password:"",direccion:{calle:"",altura:"",cp:"",piso:"",departamento:""},identificador:""},isPwd:!0}},created(){this.getUser()},methods:{updateUser(){if(this.isInvalidForm())return;const e={direccion:{calle:this.user.direccion.calle,altura:this.user.direccion.altura,cp:this.user.direccion.cp,piso:this.user.direccion.piso,departamento:this.user.direccion.departamento}};this.user.password&&(e.password=this.user.password,e.confirmPassword=this.user.password),this.loading=!0,this.$axios({method:"PUT",url:"/api/user",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")},data:e}).then((e=>{this.$q.notify({position:"bottom-right",color:"positive",message:"Usuario actualizado"}),this.loading=!1,this.$router.push("/")})).catch((e=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al actualizar el usuario"}),this.loading=!1}))},getUser(){this.$axios({method:"GET",url:"/api/user",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")}}).then((e=>{this.user=e.data.data})).catch((e=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al obtener los datos del usuario"})}))},isInvalidForm(){return!(!this.user.password||(this.$refs.passwordRef.validate(),!this.$refs.passwordRef.hasError))||(this.$refs.calleRef.validate(),this.$refs.alturaRef.validate(),this.$refs.cpRef.validate(),this.$refs.pisoRef.validate(),this.$refs.departamentoRef.validate(),!!(this.$refs.calleRef.hasError||this.$refs.alturaRef.hasError||this.$refs.cpRef.hasError||this.$refs.pisoRef.hasError||this.$refs.departamentoRef.hasError))}}};var p=r(4260),h=r(151),f=r(5589),y=r(4842),g=r(5869),b=r(5269),w=r(4554),$=r(8240),v=r(7518),V=r.n(v);const q=(0,p.Z)(m,[["render",d]]),k=q;V()(m,"components",{QCard:h.Z,QCardSection:f.Z,QInput:y.Z,QSeparator:g.Z,QForm:b.Z,QIcon:w.Z,QBtn:$.Z})},5447:(e,a,r)=>{r.d(a,{Z:()=>p});var o=r(3673);const l={class:"row justify-start back-button"},t={class:"col-auto"};function s(e,a,r,s,i,n){const d=(0,o.up)("q-btn");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",t,[(0,o.Wm)(d,{onClick:n.goBack,icon:"arrow_back",flat:"",label:"Atras",color:"primary",class:"q-pa-md"},null,8,["onClick"])])])}const i={name:"BackButton",methods:{goBack(){this.$router.go(-1)}}};var n=r(4260),d=r(8240),u=r(7518),c=r.n(u);const m=(0,n.Z)(i,[["render",s]]),p=m;c()(i,"components",{QBtn:d.Z})},7124:(e,a,r)=>{r.d(a,{Z:()=>c});var o=r(3673),l=r(2323);const t={class:"q-mb-md"},s={class:"text-h5 text-weight-light"};function i(e,a,r,i,n,d){return(0,o.wg)(),(0,o.iD)("div",t,[(0,o._)("div",s,(0,l.zw)(r.title),1)])}const n={name:"Title",props:{title:{type:String,required:!0}}};var d=r(4260);const u=(0,d.Z)(n,[["render",i]]),c=u}}]);