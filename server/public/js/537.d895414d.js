"use strict";(self["webpackChunkedrans_client"]=self["webpackChunkedrans_client"]||[]).push([[537],{5860:(t,o,e)=>{e.d(o,{Z:()=>p});var a=e(3673);const n={class:"row justify-start back-button"},i={class:"col-auto"};function r(t,o,e,r,l,s){const c=(0,a.up)("q-btn");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[(0,a.Wm)(c,{onClick:s.goBack,icon:"arrow_back",flat:"",label:"Atras",color:"primary",class:"q-pa-md"},null,8,["onClick"])])])}const l={name:"BackButton",methods:{goBack(){this.$router.go(-1)}}};var s=e(4260),c=e(8240),d=e(7518),u=e.n(d);const m=(0,s.Z)(l,[["render",r]]),p=m;u()(l,"components",{QBtn:c.Z})},2816:(t,o,e)=>{e.d(o,{Z:()=>u});var a=e(3673),n=e(2323);const i={class:"q-mb-md"},r={class:"text-h5 text-weight-light"};function l(t,o,e,l,s,c){return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",r,(0,n.zw)(e.title),1)])}const s={name:"Title",props:{title:{type:String,required:!0}}};var c=e(4260);const d=(0,c.Z)(s,[["render",l]]),u=d},9537:(t,o,e)=>{e.r(o),e.d(o,{default:()=>T});var a=e(3673),n=e(2323);const i=t=>((0,a.dD)("data-v-35ad137d"),t=t(),(0,a.Cn)(),t),r={class:"base-width"},l={class:"cartTable"},s=["src"],c={style:{"max-width":"150px"},class:"ellipsis"},d={style:{"max-width":"250px"},class:"ellipsis"},u=i((()=>(0,a._)("b",null,"Total:",-1))),m={style:{width:"100% flex justify-right"}};function p(t,o,e,i,p,h){const g=(0,a.up)("back-button"),w=(0,a.up)("page-title"),b=(0,a.up)("q-avatar"),f=(0,a.up)("q-td"),y=(0,a.up)("q-btn"),k=(0,a.up)("q-tr"),q=(0,a.up)("sapn"),v=(0,a.up)("q-table"),_=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(_,{padding:"",class:"column items-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(g),(0,a._)("div",r,[(0,a.Wm)(w,{title:"Carrito"}),(0,a._)("div",l,[(0,a.Wm)(v,{rows:p.rows,columns:p.columns,"row-key":"name",loading:p.loading,"no-data-label":"No se encontraron productos en el carrito..."},{body:(0,a.w5)((t=>[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a._)("img",{src:"https://coderhouse-ecommerce.s3.amazonaws.com/"+t.row.product.fotos[0]},null,8,s)])),_:2},1024)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",c,(0,n.zw)(t.row.product.nombre),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",d,(0,n.zw)(t.row.product.descripcion),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.row.qty),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(h.formattedPrice(t.row.product.precio)),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{onClick:o=>h.removeItem(t.row),flat:"",round:"",color:"red",icon:"delete"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),"bottom-row":(0,a.w5)((()=>[p.rows.length>0?((0,a.wg)(),(0,a.j4)(k,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{colspan:"100%"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,null,{default:(0,a.w5)((()=>[u,(0,a.Uk)(" $ "+(0,n.zw)(p.total),1)])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1},8,["rows","columns","loading"]),(0,a._)("div",m,[(0,a.Wm)(y,{class:"q-mt-md",onClick:h.buy,color:"primary",label:"Comprar",disable:p.btnLoading},null,8,["onClick","disable"])])])])])),_:1})}var h=e(2816),g=e(5860);const w={name:"Cart",components:{PageTitle:h.Z,BackButton:g.Z},data(){return{btnLoading:!1,loading:!1,total:0,rows:[],columns:[{name:"imagen",required:!0,label:"",align:"left",sortable:!1},{name:"nombre",required:!0,label:"Nombre",align:"left"},{name:"descripcion",label:"Descripción",align:"left"},{name:"qty",label:"Cantidad",field:"qty",align:"left"},{name:"precio",label:"Precio",align:"left"},{name:"remove",label:""}]}},created(){this.getProducts()},methods:{async getProducts(){this.loading=!0,this.$axios({method:"GET",url:"/api/cart",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")}}).then((t=>{this.rows=t.data.data.products,this.total=t.data.data.products.reduce(((t,o)=>t+o.product.precio*o.qty),0),this.loading=!1})).catch((t=>{this.rows=[],this.loading=!1}))},buy(){this.btnLoading=!0,this.$axios({method:"GET",url:"/api/cart/submit",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")}}).then((()=>{this.$q.notify({position:"bottom-right",color:"positive",message:"Compra realizada con éxito"}),this.btnLoading=!1,this.getProducts()})).catch((t=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al realizar la compra"}),this.btnLoading=!1}))},removeItem(t){this.btnLoading=!0;const o={product:t.product.id,qty:t.qty};this.$axios({method:"POST",url:"/api/cart/delete",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+this.$q.cookies.get("token")},data:o}).then((()=>{this.$q.notify({position:"bottom-right",color:"positive",message:"Producto eliminado con éxito"}),this.btnLoading=!1,this.getProducts()})).catch((t=>{this.$q.notify({position:"bottom-right",color:"negative",message:"Error al eliminar el producto"}),this.btnLoading=!1}))},formattedPrice(t){return t.toLocaleString("es-AR",{style:"currency",currency:"ARS"})}}};var b=e(4260),f=e(4379),y=e(740),k=e(8186),q=e(3884),v=e(5096),_=e(8240),C=e(7518),W=e.n(C);const Z=(0,b.Z)(w,[["render",p],["__scopeId","data-v-35ad137d"]]),T=Z;W()(w,"components",{QPage:f.Z,QTable:y.Z,QTr:k.Z,QTd:q.Z,QAvatar:v.Z,QBtn:_.Z})}}]);